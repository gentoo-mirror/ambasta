From a1b0a591a48de1a04edc27a69d848db9633ee8ad Mon Sep 17 00:00:00 2001
From: Amit Prakash Ambasta <amit.prakash.ambasta@gmail.com>
Date: Mon, 14 Mar 2022 13:15:41 +0530
Subject: [PATCH] Strip as-needed from libmozgtk

Signed-off-by: Amit Prakash Ambasta <amit.prakash.ambasta@gmail.com>
---
 toolkit/library/moz.build | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/toolkit/library/moz.build b/toolkit/library/moz.build
index 0f9d7e95bf..0c02a1c760 100644
--- a/toolkit/library/moz.build
+++ b/toolkit/library/moz.build
@@ -107,6 +107,9 @@ def Libxul(name, output_category=None):
         LDFLAGS += CONFIG["RUSTC_NATVIS_LDFLAGS"]
 
     if CONFIG["OS_ARCH"] == "Linux" and CONFIG["OS_TARGET"] != "Android":
+
+        if CONFIG["GCC_USE_GNU_LD"]:
+            LDFLAGS += ["-Wl,--no-as-needed"]
         GeneratedFile(
             "symverscript",
             script="/build/gen_symverscript.py",
-- 
2.35.1

